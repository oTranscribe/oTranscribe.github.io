function setFromTimestamp(a,b){ts.setFrom(a,b)}!function(a){function b(a,b,c,d){if(a.tag.format&&c.length>0){c.push("\n");for(var e=0;d>e;e++)c.push("	")}}function c(d,e){var f=[],g=0==d.attributes.length,h=0;if(d.tag.isComment)e.allowComments&&(f.push("<!--"),f.push(d.tag.rawAttributes),f.push(">"),e.format&&b(d,e,f,h-1));else{var i=0==e.removeTagsAndContent.length||-1==a.inArray(d.tag.name,e.removeTagsAndContent),n=i&&d.tag.render&&(0==e.allowedTags.length||a.inArray(d.tag.name,e.allowedTags)>-1)&&(0==e.removeTags.length||-1==a.inArray(d.tag.name,e.removeTags));if(!d.isRoot&&n&&(f.push("<"),f.push(d.tag.name),a.each(d.attributes,function(){if(-1==a.inArray(this.name,e.removeAttrs)){var b=RegExp(/^(['"]?)(.*?)['"]?$/).exec(this.value),c=b[2],g=b[1]||"'";"class"==this.name&&e.allowedClasses.length>0&&(c=a.grep(c.split(" "),function(b){return a.grep(e.allowedClasses,function(c){return c==b||c[0]==b&&(1==c.length||a.inArray(d.tag.name,c[1])>-1)}).length>0}).join(" ")),null!=c&&(c.length>0||a.inArray(this.name,d.tag.requiredAttributes)>-1)&&(f.push(" "),f.push(this.name),f.push("="),f.push(g),f.push(c),f.push(g))}})),d.tag.isSelfClosing)n&&f.push(" />"),g=!1;else if(d.tag.isNonClosing)g=!1;else if(i){if(!d.isRoot&&n&&f.push(">"),h=e.formatIndent++,d.tag.toProtect)p=a.htmlClean.trim(d.children.join("")).replace(/<br>/gi,"\n"),f.push(p),g=0==p.length;else{for(var p=[],q=0;q<d.children.length;q++){var r=d.children[q],s=a.htmlClean.trim(o(l(r)?r:r.childrenToString()));m(r)&&q>0&&s.length>0&&(j(r)||k(d.children[q-1]))&&p.push(" "),l(r)?s.length>0&&p.push(s):(q!=d.children.length-1||"br"!=r.tag.name)&&(e.format&&b(r,e,p,h),p=p.concat(c(r,e)))}e.formatIndent--,p.length>0&&(e.format&&"\n"!=p[0]&&b(d,e,f,h),f=f.concat(p),g=!1)}!d.isRoot&&n&&(e.format&&b(d,e,f,h-1),f.push("</"),f.push(d.tag.name),f.push(">"))}if(!d.tag.allowEmpty&&g)return[]}return f}function d(b,c){return f(b,function(b){return a.inArray(b.tag.nameOriginal,c)>-1})}function e(a){return f(a,function(a){return a.isRoot||!a.tag.isInline})}function f(a,b,c){c=c||1;var d=a[a.length-c];return b(d)?!0:a.length-c>0&&f(a,b,c+1)?(a.pop(),!0):!1}function g(a){return a?(this.tag=a,this.isRoot=!1):(this.tag=new i("root"),this.isRoot=!0),this.attributes=[],this.children=[],this.hasAttribute=function(a){for(var b=0;b<this.attributes.length;b++)if(this.attributes[b].name==a)return!0;return!1},this.childrenToString=function(){return this.children.join("")},this}function h(a,b){return this.name=a,this.value=b,this}function i(b,c,d,e){return this.name=b.toLowerCase(),this.nameOriginal=this.name,this.render=!0,this.init=function(){if("--"==this.name?(this.isComment=!0,this.isSelfClosing=!0,this.format=!0):(this.isComment=!1,this.isSelfClosing=a.inArray(this.name,v)>-1,this.isNonClosing=a.inArray(this.name,w)>-1,this.isClosing=void 0!=c&&c.length>0,this.isInline=a.inArray(this.name,p)>-1,this.disallowNest=a.inArray(this.name,r)>-1,this.requiredParent=t[a.inArray(this.name,t)+1],this.allowEmpty=e&&a.inArray(this.name,e.allowEmpty)>-1,this.toProtect=a.inArray(this.name,u)>-1,this.format=a.inArray(this.name,q)>-1||!this.isInline),this.rawAttributes=d,this.requiredAttributes=y[a.inArray(this.name,y)+1],e){if(e.tagAttributesCache||(e.tagAttributesCache=[]),-1==a.inArray(this.name,e.tagAttributesCache)){for(var b=x[a.inArray(this.name,x)+1].slice(0),f=0;f<e.allowedAttributes.length;f++){var g=e.allowedAttributes[f][0];(1==e.allowedAttributes[f].length||a.inArray(this.name,e.allowedAttributes[f][1])>-1)&&-1==a.inArray(g,b)&&b.push(g)}e.tagAttributesCache.push(this.name),e.tagAttributesCache.push(b)}this.allowedAttributes=e.tagAttributesCache[a.inArray(this.name,e.tagAttributesCache)+1]}},this.init(),this.rename=function(a){this.name=a,this.init()},this}function j(b){for(;n(b)&&b.children.length>0;)b=b.children[0];if(!l(b))return!1;var c=o(b);return c.length>0&&a.htmlClean.isWhitespace(c.charAt(0))}function k(b){for(;n(b)&&b.children.length>0;)b=b.children[b.children.length-1];if(!l(b))return!1;var c=o(b);return c.length>0&&a.htmlClean.isWhitespace(c.charAt(c.length-1))}function l(a){return a.constructor==String}function m(a){return l(a)||a.tag.isInline}function n(a){return a.constructor==g}function o(a){return a.replace(/&nbsp;|\n/g," ").replace(/\s\s+/g," ")}a.fn.htmlClean=function(b){return this.each(function(){this.value?this.value=a.htmlClean(this.value,b):this.innerHTML=a.htmlClean(this.innerHTML,b)})},a.htmlClean=function(b,f){f=a.extend({},a.htmlClean.defaults,f),f.allowEmpty=s.concat(f.allowEmpty);var j,k=/(<(\/)?(\w+:)?([\w]+)([^>]*)>)|<!--(.*?--)>/gi,m=/([\w\-]+)\s*=\s*(".*?"|'.*?'|[^\s>\/]*)/gi,n=new g,o=[n],p=n;f.bodyOnly&&(j=/<body[^>]*>((\n|.)*)<\/body>/i.exec(b))&&(b=j[1]),b=b.concat("<xxx>");for(var q;j=k.exec(b);){var r=j[6]?new i("--",null,j[6],f):new i(j[4],j[2],j[5],f),t=b.substring(q,j.index);if(t.length>0){var u=p.children[p.children.length-1];p.children.length>0&&l(u=p.children[p.children.length-1])?p.children[p.children.length-1]=u.concat(t):p.children.push(t)}if(q=k.lastIndex,r.isClosing)d(o,[r.name])&&(o.pop(),p=o[o.length-1]);else{for(var v,w=new g(r);v=m.exec(r.rawAttributes);){if("style"==v[1].toLowerCase()&&f.replaceStyles)for(var x=!r.isInline,y=0;y<f.replaceStyles.length;y++)f.replaceStyles[y][0].test(v[2])&&(x||(r.render=!1,x=!0),p.children.push(w),o.push(w),p=w,r=new i(f.replaceStyles[y][1],"","",f),w=new g(r));null!=r.allowedAttributes&&(0==r.allowedAttributes.length||a.inArray(v[1],r.allowedAttributes)>-1)&&w.attributes.push(new h(v[1],v[2]))}a.each(r.requiredAttributes,function(){var a=this.toString();w.hasAttribute(a)||w.attributes.push(new h(a,""))});for(var z=0;z<f.replace.length;z++)for(var A=0;A<f.replace[z][0].length;A++){var B="string"==typeof f.replace[z][0][A];if(B&&f.replace[z][0][A]==r.name||!B&&f.replace[z][0][A].test(j)){r.rename(f.replace[z][1]),z=f.replace.length;break}}var C=!0;if(p.isRoot||(p.tag.isInline&&!r.isInline?(C=e(o))&&(p=o[o.length-1]):p.tag.disallowNest&&r.disallowNest&&!r.requiredParent?C=!1:r.requiredParent&&(C=d(o,r.requiredParent))&&(p=o[o.length-1])),C)if(p.children.push(w),r.toProtect)for(var D;D=k.exec(b);){var E=new i(D[4],D[1],D[5],f);if(E.isClosing&&E.name==r.name){w.children.push(RegExp.leftContext.substring(q)),q=k.lastIndex;break}}else r.isSelfClosing||r.isNonClosing||(o.push(w),p=w)}}return a.htmlClean.trim(c(n,f).join(""))},a.htmlClean.defaults={bodyOnly:!0,allowedTags:[],removeTags:["basefont","center","dir","font","frame","frameset","iframe","isindex","menu","noframes","s","strike","u"],removeTagsAndContent:[],allowedAttributes:[],removeAttrs:[],allowedClasses:[],format:!1,formatIndent:0,replace:[[["b","big"],"strong"],[["i"],"em"]],replaceStyles:[[/font-weight:\s*bold/i,"strong"],[/font-style:\s*italic/i,"em"],[/vertical-align:\s*super/i,"sup"],[/vertical-align:\s*sub/i,"sub"]],allowComments:!1,allowEmpty:[]},a.htmlClean.trim=function(b){return a.htmlClean.trimStart(a.htmlClean.trimEnd(b))},a.htmlClean.trimStart=function(b){return b.substring(a.htmlClean.trimStartIndex(b))},a.htmlClean.trimStartIndex=function(b){for(var c=0;c<b.length-1&&a.htmlClean.isWhitespace(b.charAt(c));c++);return c},a.htmlClean.trimEnd=function(b){return b.substring(0,a.htmlClean.trimEndIndex(b))},a.htmlClean.trimEndIndex=function(b){for(var c=b.length-1;c>=0&&a.htmlClean.isWhitespace(b.charAt(c));c--);return c+1},a.htmlClean.isWhitespace=function(b){return-1!=a.inArray(b,z)};var p=["a","abbr","acronym","address","b","big","br","button","caption","cite","code","del","em","font","hr","i","input","img","ins","label","legend","map","q","s","samp","select","option","param","small","span","strike","strong","sub","sup","tt","u","var"],q=["address","button","caption","code","input","label","legend","select","option","param"],r=["h1","h2","h3","h4","h5","h6","p","th","td","object"],s=["th","td"],t=[null,"li",["ul","ol"],"dt",["dl"],"dd",["dl"],"td",["tr"],"th",["tr"],"tr",["table","thead","tbody","tfoot"],"thead",["table"],"tbody",["table"],"tfoot",["table"],"param",["object"]],u=["script","style","pre","code"],v=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],w=["!doctype","?xml"],x=[["class"],"?xml",[],"!doctype",[],"a",["accesskey","class","href","name","title","rel","rev","type","tabindex"],"abbr",["class","title"],"acronym",["class","title"],"blockquote",["cite","class"],"button",["class","disabled","name","type","value"],"del",["cite","class","datetime"],"form",["accept","action","class","enctype","method","name"],"iframe",["class","height","name","sandbox","seamless","src","srcdoc","width"],"input",["accept","accesskey","alt","checked","class","disabled","ismap","maxlength","name","size","readonly","src","tabindex","type","usemap","value"],"img",["alt","class","height","src","width"],"ins",["cite","class","datetime"],"label",["accesskey","class","for"],"legend",["accesskey","class"],"link",["href","rel","type"],"meta",["content","http-equiv","name","scheme","charset"],"map",["name"],"optgroup",["class","disabled","label"],"option",["class","disabled","label","selected","value"],"q",["class","cite"],"script",["src","type"],"select",["class","disabled","multiple","name","size","tabindex"],"style",["type"],"table",["class","summary"],"th",["class","colspan","rowspan"],"td",["class","colspan","rowspan"],"textarea",["accesskey","class","cols","disabled","name","readonly","rows","tabindex"],"param",["name","value"],"embed",["height","src","type","width"]],y=[[],"img",["alt"]],z=[" "," ","	","\n","\r","\f"]}(jQuery);var toMarkdown=function(a){function b(a,b){var c="void"===b.type?"<"+b.tag+"\\b([^>]*)\\/?>":"<"+b.tag+"\\b([^>]*)>([\\s\\S]*?)<\\/"+b.tag+">",d=new RegExp(c,"gi"),e="";return e="string"==typeof b.replacement?a.replace(d,b.replacement):a.replace(d,function(a,c,d,e){return b.replacement.call(this,a,c,d,e)})}function c(a){return new RegExp(a+"\\s*=\\s*[\"']?([^\"']*)[\"']?","i")}function d(a){return a=a.replace(/<(ul|ol)\b[^>]*>([\s\S]*?)<\/\1>/gi,function(a,b,c){var d=c.split("</li>");for(d.splice(d.length-1,1),h=0,i=d.length;i>h;h++)if(d[h]){var e="ol"===b?h+1+".  ":"*   ";d[h]=d[h].replace(/\s*<li[^>]*>([\s\S]*)/i,function(a,b){return b=b.replace(/^\s+/,""),b=b.replace(/\n\n/g,"\n\n    "),b=b.replace(/\n([ ]*)+(\*|\d+\.) /g,"\n$1    $2 "),e+b})}return d.join("\n")}),"\n\n"+a.replace(/[ \t]+\n|\s+$/g,"")}function e(a){return a=a.replace(/<blockquote\b[^>]*>([\s\S]*?)<\/blockquote>/gi,function(a,b){return b=b.replace(/^\s+|\s+$/g,""),b=f(b),b=b.replace(/^/gm,"> "),b=b.replace(/^(>([ \t]{2,}>)+)/gm,"> >")})}function f(a){return a=a.replace(/^[\t\r\n]+|[\t\r\n]+$/g,""),a=a.replace(/\n\s+\n/g,"\n\n"),a=a.replace(/\n{3,}/g,"\n\n")}for(var g=[{patterns:"p",replacement:function(a,b,c){return c?"\n\n"+c+"\n":""}},{patterns:"br",type:"void",replacement:"\n"},{patterns:"h([1-6])",replacement:function(a,b,c,d){for(var e="",f=0;b>f;f++)e+="#";return"\n\n"+e+" "+d+"\n"}},{patterns:"hr",type:"void",replacement:"\n\n* * *\n"},{patterns:"a",replacement:function(a,b,d){var e=b.match(c("href")),f=b.match(c("title"));return e?"["+d+"]("+e[1]+(f&&f[1]?' "'+f[1]+'"':"")+")":a}},{patterns:["b","strong"],replacement:function(a,b,c){return c?"**"+c+"**":""}},{patterns:["i","em"],replacement:function(a,b,c){return c?"_"+c+"_":""}},{patterns:"code",replacement:function(a,b,c){return c?"`"+c+"`":""}},{patterns:"img",type:"void",replacement:function(a,b){var d=b.match(c("src")),e=b.match(c("alt")),f=b.match(c("title"));return"!["+(e&&e[1]?e[1]:"")+"]("+d[1]+(f&&f[1]?' "'+f[1]+'"':"")+")"}}],h=0,i=g.length;i>h;h++)if("string"==typeof g[h].patterns)a=b(a,{tag:g[h].patterns,replacement:g[h].replacement,type:g[h].type});else for(var j=0,k=g[h].patterns.length;k>j;j++)a=b(a,{tag:g[h].patterns[j],replacement:g[h].replacement,type:g[h].type});a=a.replace(/<pre\b[^>]*>`([\s\S]*)`<\/pre>/gi,function(a,b){return b=b.replace(/^\t+/g,"  "),b=b.replace(/\n/g,"\n    "),"\n\n    "+b+"\n"}),a=a.replace(/^(\s{0,3}\d+)\. /g,"$1\\. ");for(var l=/<(ul|ol)\b[^>]*>(?:(?!<ul|<ol)[\s\S])*?<\/\1>/gi;a.match(l);)a=a.replace(l,function(a){return d(a)});for(var m=/<blockquote\b[^>]*>((?:(?!<blockquote)[\s\S])*?)<\/blockquote>/gi;a.match(m);)a=a.replace(m,function(a){return e(a)});return f(a)};"object"==typeof exports&&(exports.toMarkdown=toMarkdown);var oT={};!function(){function a(){var a=$(".controls"),b=$(window).width()-(a.width()+$(".title").outerWidth()+$(".help-title").outerWidth()+$(".language-title").outerWidth());$("#player-hook").width($("#player-hook").width()+b-10)}function b(){$(".help-title").removeClass("active"),$(".help").removeClass("active"),$(".title").toggleClass("active"),$(".about").toggleClass("active")}function c(){$(".textbox-container").height(window.innerHeight-36)}function d(){var a=parseInt($("#textbox").offset().left,10)+700;$(".text-panel").css("left",a)}function e(a){var b=$.trim(a);return b?b.match(/\S+/gi).length:0}function f(){var a=document.getElementById("textbox"),b=a.innerText||a.textContent,c=e(b);document.getElementById("wc").innerHTML=c;var d=document.webL10n.get("wordcount",{n:c});document.querySelector(".wc-text").innerHTML=d}function g(){setInterval(function(){f()},1e3)}function h(){var a=document.queryCommandState("Bold"),b=document.getElementById("icon-b"),c=document.queryCommandState("italic"),d=document.getElementById("icon-i");b.className=a===!0?"fa fa-bold active":"fa fa-bold",d.className=c===!0?"fa fa-italic active":"fa fa-italic"}function i(){setInterval(function(){h()},100)}function j(a){var b=document.createElement("audio");return!(!b.canPlayType||!b.canPlayType("audio/"+a+";").replace(/no/,""))}function k(a){if("audio"==a)var b=["mp3","ogg","webm","wav"];else if("video"==a)var b=["mp4","ogg","webm"];var c=[],d=0;return b.forEach(function(a){1==j(a)&&(c[d]=a,d++)}),c.join("/")}function l(a){var b=a.type.split("/")[0],c=document.createElement(b);return!(!c.canPlayType||!c.canPlayType(a.type).replace(/no/,""))}function m(){var a=document.webL10n.get("formats");a=a.replace("[xxx]",k("audio")),a=a.replace("[yyy]",k("video")),document.getElementById("formats").innerHTML=a}function n(){var a=document.webL10n.get("start-ready");$(".start").text(a).addClass("ready")}function o(){var a=!!document.createElement("audio").canPlayType,b=document.getElementById("textbox").contentEditable,c=!!window.FileReader;return a&&b&&c?!0:!1}function p(){if(o()===!1){var a=document.webL10n.get("old-browser-warning");document.getElementById("old-browser").innerHTML=a}}function q(){var a=window.navigator.userAgent;a.indexOf("CrOS")>-1&&(Mousetrap.bind("ctrl+1",function(a){return v(a),oT.player.skip("backwards"),!1}),Mousetrap.bind("ctrl+2",function(a){return v(a),oT.player.skip("forwards"),!1}),Mousetrap.bind("ctrl+3",function(a){return v(a),oT.player.speed("down"),!1}),Mousetrap.bind("ctrl+4",function(a){return v(a),oT.player.speed("up"),!1}))}function r(){var a=document.getElementById("textbox");localStorage.getItem("autosave")&&(a.innerHTML=localStorage.getItem("autosave")),setTimeout(function(){$("#textbox p[data-l10n-id]").attr("data-l10n-id",""),setInterval(function(){oT.backup.saveToLocalStorage("autosave",a.innerHTML)},1e3)},5e3)}function s(){r(),oT.backup.init(),c(),d(),oT.input.dragListener(),g(),i(),oT.timestamp.activate(),q(),w.loadGoogleApiAsync()}function t(){x.mdButton(),x.txtButton(),oT.export.placeButton("otr"),w.handleClientLoad();var a=$("#icon-exp").offset(),b=parseInt($("body").width()-a.left+25),c=parseInt(a.top)-50;$(".export-panel").css({right:b,top:c}).addClass("active")}function u(){$(".export-panel").removeClass("active"),$(".export-block-gd")[0].outerHTML=w.button()}function v(a){a.preventDefault?a.preventDefault():a.returnValue=!1}oT.media={},oT.player=function(){},oT.player.playPause=function(){},oT.player.skipTo=function(){},oT.player.skip=function(){},oT.player.speed=function(){},oT.media.create=function(b){oT.media.reset({callback:function(){oT.player=new oT.playerObj(b)}}),oT.input.hide(),setInterval(function(){a()},500)},oT.playerObj=function(a){if(this.file=a.file,a.startpoint&&(this._startPoint=a.startpoint),this.file.indexOf&&oT.media.ytParse(this.file))this.format="youtube",$("#player-time").hide(),this._buildYoutube();else{var b=this._createObjectURL(a.file);this.file.type.indexOf("video")>-1?(this._buildVideo(b),this.format="video"):(this._buildAudio(b),this.format="audio"),this.title=this.file.name,this._initProgressor()}this.paused=!0},oT.playerObj.prototype._initProgressor=function(){this.progressBar=new Progressor({media:this.element,bar:$("#player-hook")[0],text:this.title,time:$("#player-time")[0]})},oT.playerObj.prototype._createObjectURL=function(a){return window.webkitURL?window.webkitURL.createObjectURL(a):window.URL.createObjectURL(a)},oT.playerObj.prototype._buildVideo=function(a){this.element=document.createElement("video"),this.element.src=a,this.element.id="media",this.element.style.width=oT.media.videoWidth(),document.body.appendChild(this.element)},oT.playerObj.prototype._buildAudio=function(a){this.element=document.createElement("audio"),this.element.src=a,this.element.id="media",$("#player-hook").append(this.element)},oT.playerObj.prototype.remove=function(){$(this.element).remove()},oT.playerObj.prototype.pause=function(){var a=$(".play-pause");a.removeClass("playing"),"youtube"===this.format?this._ytEl.pauseVideo():this.element.pause(),this.paused=!0},oT.playerObj.prototype.play=function(){var a=$(".play-pause");this.skip("backwards"),a.addClass("playing"),"youtube"===this.format?this._ytEl.playVideo():this.element.play(),this.paused=!1},oT.playerObj.prototype.playPause=function(){this.paused===!1?this.pause():this.play()},oT.playerObj.prototype.skipTo=function(a){"youtube"===this.format?this._ytEl.seekTo(a):this.element.currentTime=a},oT.playerObj.prototype.skip=function(a){var b=1;"backwards"==a&&(b=-1),this.skipTo(this.element.currentTime+1.5*b)},oT.playerObj.prototype.speed=function(a){var b=this.element;"youtube"===this.format&&(b=this._ytEl);var c,d=.5,e=2,f=oT.media.speedIncrement||.25,g=this.element.playbackRate;"up"==a&&e>g?c=g+f:"down"==a&&g>d?c=g-f:"reset"==a?c=1:"number"==typeof a&&(c=a),"undefined"!=typeof c&&(b.playbackRate=c,b.setPlaybackRate&&b.setPlaybackRate(c),document.getElementById("slider3").value=c)},oT.playerObj.prototype.getTime=function(){return this.element.currentTime},oT.playerObj.prototype.getDuration=function(){return this.element.duration},oT.playerObj.prototype.reset=function(){this.speed("reset"),$("#media").remove(),$("#player-time").show(),$("#player-hook").removeClass("progressor media-title media-titleprogressor").empty()},oT.media.reset=function(a){a=a||{},oT.player.reset&&(oT.player.reset(),oT.player={}),a.input&&(oT.input.loadPreviousFileDetails(),oT.input.show()),a.callback&&setTimeout(function(){a.callback()},500)},oT.media.videoWidth=function(){var a=document.getElementById("textbox").getBoundingClientRect().left;return a>200?a-40+"px":void 0},oT.media.initAudioJS=function(){audiojs.events.ready(function(){audiojs.createAll()})},oT.media.disableSpeed=function(){$(".speed-box").html("This media only supports 1x playback rate. Sorry."),oT.media.speed=function(){return!1}},oT.playerObj.prototype._youtubeReady=function(){function a(a){var b=a.data;this.paused=2===b?!0:!1}var b=this,c=oT.media.ytParse(this.file);this._ytEl=new YT.Player("media",{width:"100%",videoId:c,playerVars:{disablekb:1,fs:0,rel:0,modestbranding:1},events:{onReady:this._youtubeReadyPartTwo.bind(this),onStateChange:a}}),this._setYoutubeTitle(c),setInterval(function(){b.element.currentTime=b._ytEl.getCurrentTime()},200),$("#slider3").attr("step",.5),oT.media.speedIncrement=.5},oT.playerObj.prototype._youtubeReadyPartTwo=function(){$("#slider3").val(.5).change().val(1).change(),1===this._ytEl.getAvailablePlaybackRates()[0]&&oT.media.disableSpeed(),this.element.duration=this._ytEl.getDuration();var a=this;setTimeout(function(){this.play(),setTimeout(function(){a.pause(),oT.media.startPoint&&setTimeout(function(){a.seekTo(oT.media.startPoint)},500)},500)},1e3)},oT.playerObj.prototype._buildYoutube=function(a){if(this.url=a,this.element=document.createElement("div"),this.element.setAttribute("id","media"),document.body.appendChild(this.element),setInterval(function(){var a=$("iframe#media");a.width(oT.media.videoWidth),a.height(.75*a.width())},500),0===$("#youtube-script").length){var b=document.createElement("script");b.setAttribute("id","youtube-script"),b.src="https://www.youtube.com/iframe_api";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}else this._youtubeReady(this);window.onYouTubeIframeAPIReady=this._youtubeReady.bind(this)},oT.media.ytParse=function(a){if(a.match){var b=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,c=a.match(b);if(c&&11==c[2].length)return c[2]}return!1},oT.playerObj.prototype._setYoutubeTitle=function(b){var c="http://gdata.youtube.com/feeds/api/videos/"+b+"?v=2&alt=json-in-script&callback=?";$.ajax({type:"GET",url:c,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(c){var d="[YouTube] "+c.entry.title.$t;this.title=d,oT.input.saveFileDetails({name:d,source:"https://www.youtube.com/watch?v="+b}),$("#player-hook").html(d).addClass("media-title"),a()},error:function(a){console.log(a)}})},oT.input={},oT.input.reactToFile=function(b){var c=b.files[0];if(l(c)===!0)oT.media.create({file:c}),a(),oT.input.saveFileDetails(c.name);else{var d=document.webL10n.get("format-warn");d=d.replace("[file-format]",c.type.split("/")[1]),$("#formats").html(d).addClass("warning")}},oT.input.askForYoutube=function(){$(".input").addClass("ext-input");var a=$(".ext-input input");a.focus(),a.keypress(function(a){return 13==a.which?(oT.input.reactToYoutube($(this).val()),!1):void 0})},oT.input.reactToYoutube=function(a){if(oT.media.ytParse(a))oT.input.processYoutube(a),$(".input").removeClass("ext-input");else{var b=document.webL10n.get("youtube-error");$(".ext-input-warning").text(b).show()}},oT.input.returnToNormal=function(){$(".input").removeClass("ext-input")},oT.input.processYoutube=function(a){oT.media.create({file:a})},oT.input.loadPreviousFileDetails=function(){if(localStorage.getItem("oT-lastfile")){var a=JSON.parse(localStorage.getItem("oT-lastfile")),b=document.webL10n.get("last-file");if(void 0===a.name)document.getElementById("lastfile").innerHTML=b+" "+a;else if(""===a.source)document.getElementById("lastfile").innerHTML=b+" "+a.name;else{var c=document.getElementById("lastfile");c.innerHTML=b+' <span class="media-reload">'+a.name+"</span>",c.addEventListener("click",function(){oT.input.processYoutube(a.source)})}}},oT.input.saveFileDetails=function(a){var b=a;"string"==typeof file&&(b={name:a,source:""}),localStorage.setItem("oT-lastfile",JSON.stringify(b))},oT.input.dragListener=function(){var a=$(".file-input-wrapper")[0];a.addEventListener("dragover",function(){$(".file-input-wrapper").addClass("hover")},!1),a.addEventListener("dragleave",function(){$(".file-input-wrapper").removeClass("hover")},!1)},oT.input.show=function(){$(".topbar").addClass("inputting"),$(".input").addClass("active"),$(".sbutton.time").removeClass("active"),$(".text-panel").removeClass("editing")},oT.input.hide=function(){$(".topbar").removeClass("inputting"),$(".input").removeClass("active"),$(".sbutton.time").addClass("active"),$(".text-panel").addClass("editing")},oT.message={},oT.message.header=function(a){$(".message-panel .message-content").html(a),$(".message-panel").removeClass("hidden")},oT.message.close=function(){$(".message-panel").addClass("hidden")},oT.import={},oT.import.loadFile=function(a){try{a=JSON.parse(a),oT.import.replaceTranscriptTextWith(a.text),oT.import.remindOfMediaFile(a.media,a["media-source"],a["media-time"])}catch(b){alert("This is not a valid oTranscribe format (.otr) file.")}},oT.import.replaceTranscriptTextWith=function(a){a=oT.import.clean(a);var b=$("#textbox");b.fadeOut(300,function(){"string"==typeof a?b[0].innerHTML=a:(textbox[0].innerHTML="",b[0].appendChild(a)),oT.timestamp.activate(),$(".textbox-container").scrollTop(0),$(this).fadeIn(300)})},oT.import.remindOfMediaFile=function(a,b,c){if(a&&""!==a){var d="File last used with imported document:";b&&oT.media.ytParse(b)?(oT.message.header(d+' <a href="#" id="restore-media">'+a+"</a>"),$("#restore-media").click(function(){return oT.media.create({file:b,startpoint:c}),!1})):oT.message.header(d+" "+a)}},oT.import.localButtonReaction=function(a){var b=a.files[0],c=new FileReader;c.readAsText(b),c.onload=function(a){var b=a.target.result;oT.import.loadFile(b)},a.value=""},oT.import.clean=function(a){return a=oT.texteditor.clean(a)},oT.texteditor={},oT.texteditor.clean=function(a){var b=$.htmlClean(a,{format:!1,allowedTags:["p","div","strong","em","i","b","span","br"],allowedAttributes:[["class",["span"]],["data-timestamp",["span"]]],allowedClasses:["timestamp"]});return b},oT.backup={},oT.backup.openPanel=function(){oT.backup.populatePanel(),$(".backup-window").height(.6*$(".textbox-container").height()),$(".backup-panel").fadeIn("fast")},oT.backup.closePanel=function(){$(".backup-panel").fadeOut("fast",function(){$(".backup-window").empty()})},oT.backup.generateBlock=function(a){var b=localStorage.getItem(a),c=a.replace("oTranscribe-backup-",""),d=oT.backup.formatDate(c),e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");e.className="backup-block",f.className="backup-doc",g.className="backup-restore-button",f.innerHTML=b;var h=document.webL10n.get("restore-button");return g.innerHTML=d+' - <span onClick="oT.backup.restore('+c+');">'+h+"</span>",e.appendChild(f),e.appendChild(g),e},oT.backup.formatDate=function(a){var b=new Date(parseFloat(a)),c=b.getDate()+"/"+(b.getMonth()+1),d=new Date;today=d.getDate()+"/"+(d.getMonth()+1),yesterday=d.getDate()-1+"/"+(d.getMonth()+1),c===today?c=document.webL10n.get("today"):c===yesterday&&(c=document.webL10n.get("yesterday"));var e=b.getHours()+":";return b.getMinutes()<10&&(e+="0"),e+=b.getMinutes(),formattedDate=c+" "+e},oT.backup.populatePanel=function(){if(oT.backup.addDocsToPanel(0,8),0===oT.backup.list().length){var a=document.webL10n.get("no-backups");$(".backup-window").append('<div class="no-backups">'+a+"</div>")}},oT.backup.addDocsToPanel=function(a,b){$(".more-backups").remove();var c=oT.backup.list();docs=c.slice(a,b);for(var d=0;d<docs.length;d++)$(".backup-window").append(oT.backup.generateBlock(docs[d]));if(c[b]){var e=document.webL10n.get("more-backups");$(".backup-window").append('<div class="more-backups" onclick="oT.backup.addDocsToPanel('+b+","+(b+8)+')" >'+e+"</div>")}},oT.backup.save=function(){var a=document.getElementById("textbox"),b=(new Date).getTime();oT.backup.saveToLocalStorage("oTranscribe-backup-"+b,a.innerHTML),$(".sbutton.backup").addClass("flash"),setTimeout(function(){$(".sbutton.backup").removeClass("flash")},1e3);var c=oT.backup.generateBlock("oTranscribe-backup-"+b);c.className+=" new-block",$(".backup-window").prepend(c),$(c).animate({opacity:1,width:"25%"},"slow",function(){$(c).find(".backup-restore-button").fadeIn()})},oT.backup.saveToLocalStorage=function(a,b){try{localStorage.setItem(a,b)}catch(c){"NS_ERROR_DOM_QUOTA_REACHED"===c.name&&(oT.backup.removeOldest(),oT.backup.save())}},oT.backup.init=function(){setInterval(function(){oT.backup.save(),oT.backup.cleanup()},3e5)},oT.backup.list=function(){for(var a=[],b=0;b<localStorage.length;b++)localStorage.key(b).indexOf("oTranscribe-backup")>-1&&a.push(localStorage.key(b));return a.sort().reverse()},oT.backup.restore=function(a){oT.backup.save();var b=localStorage.getItem("oTranscribe-backup-"+a);oT.import.replaceTranscriptTextWith(b),oT.backup.closePanel()},oT.backup.cleanup=function(){for(var a=oT.backup.list(),b=0;b<a.length;b++){var c=a[b],d=c.replace("oTranscribe-backup-",""),e=new Date(parseFloat(d)),f=Date.now()-e;f>6048e5&&localStorage.removeItem(c)}},oT.backup.removeOldest=function(){for(var a=oT.backup.list(),b=a.slice(Math.max(a.length-5,1)),c=0;c<b.length;c++)localStorage.removeItem(b[c]),localStorage.clear(b[c])},window.addEventListener("localized",function(){m(),n(),p(),oT.input.loadPreviousFileDetails(),$("#curr-lang").text(oT.lang.langs[document.webL10n.getLanguage()])},!1),$(document).ready(function(){s(),oT.lang.bide(),localStorage.getItem("lastfile")&&b()}),$(window).resize(function(){c(),a(),d(),document.getElementById("media")&&(document.getElementById("media").style.width=oT.media.videoWidth())});var w={CLIENT_ID:"219206830455.apps.googleusercontent.com",SCOPES:"https://www.googleapis.com/auth/drive"};w.loadGoogleApiAsync=function(){var a=document.createElement("script");a.type="text/javascript",a.src="https://apis.google.com/js/client.js?onload=gd.handleClientLoad",document.body.appendChild(a)},w.handleClientLoad=function(){window.setTimeout(w.checkAuth,1)},w.checkAuth=function(){try{gapi.auth.authorize({client_id:w.CLIENT_ID,scope:w.SCOPES,immediate:!0},w.handleAuthResult)}catch(a){$(".export-block-gd").css({opacity:.5,"pointer-events":"none"})}},w.handleAuthResult=function(a){a&&!a.error?w.updateButton("Google Drive",!0,"javascript:insertFile();"):document.getElementById("x-gd-sign").onclick=function(){gapi.auth.authorize({client_id:w.CLIENT_ID,scope:w.SCOPES,immediate:!1},w.handleAuthResult)}},w.updateButton=function(a,b,c){var d=$(".export-block-gd");d[0].innerHTML=a,1==b?d.addClass("gd-authenticated").removeClass("unauth"):0==b&&d.removeClass("gd-authenticated"),d[0].href=c},w.button=function(){var a=document.webL10n.get("sign-in"),b='<a class="export-block-gd unauth" id="x-gd" target="_blank" href="javascript:void(0);">Google Drive<div class="sign-in" id="x-gd-sign">'+a+"</div></a>";return b},window.insertFile=function(a){var b=document.webL10n.get("send-drive");w.updateButton(b,!1);const c="-------314159265358979323846",d="\r\n--"+c+"\r\n",e="\r\n--"+c+"--";var f=x.reader();f.onload=function(){var b="text/html",g={title:x.name(),mimeType:"text/html"},h=btoa(f.result),i=d+"Content-Type: application/json\r\n\r\n"+JSON.stringify(g)+d+"Content-Type: "+b+"\r\nContent-Transfer-Encoding: base64\r\n\r\n"+h+e,j=gapi.client.request({path:"/upload/drive/v2/files",method:"POST",params:{uploadType:"multipart",convert:!0},headers:{"Content-Type":'multipart/mixed; boundary="'+c+'"'},body:i});a||(a=function(a){var b=document.webL10n.get("open-drive");w.updateButton(b+" &rarr;",!0,a.alternateLink)}),j.execute(a)}},oT.export={},oT.export.asFormat=function(a){if("md"===a){var b=document.getElementById("textbox").innerHTML,c=$.htmlClean(b,{format:!0,removeTags:["div","span","img","pre","text"]}),d=toMarkdown(c);return d.replace(/\t/gm,"")}if("txt"===a){var b=document.getElementById("textbox").innerHTML,c=$.htmlClean(b,{format:!0,removeTags:["div","span","img","em","strong","p","pre","text"]});return c.replace(/\t/gm,"")}if("html"===a){var b=document.getElementById("textbox").innerHTML;return b.replace("\n","")}},oT.export.placeButton=function(a){if("otr"===a){var b=oT.export.createJsonFile(),c=document.getElementById("x-otr");c.download=x.name()+".otr",c.href="data:text/plain;base64,"+x.utf8_to_b64(b)}};var x={utf8_to_b64:function(a){return window.btoa(unescape(encodeURIComponent(a)))},mdButton:function(){var a=oT.export.asFormat("md"),b=document.getElementById("x-md");b.download=x.name()+".md",b.href="data:text/plain;base64,"+x.utf8_to_b64(a)},txtButton:function(){var a=oT.export.asFormat("txt"),b=document.getElementById("x-txt");b.download=x.name()+".txt",b.href="data:text/plain;base64,"+x.utf8_to_b64(a)},name:function(){var a=new Date,b=document.webL10n.get("file-name");return b+" "+a.toUTCString()}};x.createBlob=function(){var a=document.getElementById("textbox").innerHTML,b=[a],c=new Blob(b,{type:"text/html"});return c},x.reader=function(){var a=new FileReader,b=x.createBlob();return a.readAsBinaryString(b),a},oT.export.createJsonFile=function(){var a={};return a.text=oT.export.asFormat("html"),null!==oT.player?(a.media=oT.player.title,oT.player.getTime&&(a["media-time"]=oT.player.getTime()),a["media-source"]=oT.media.ytEl?oT.media._ytEl.getVideoUrl():""):(a.media="",a["media-source"]="",a["media-time"]=""),JSON.stringify(a)
},oT.lang={},oT.lang.langs={en:"English",pirate:"Pirate",es:"Español",de:"Deutsch",fr:"Français",nl:"Nederlands",pl:"Polski","zh-hant":"繁體中文","zh-hans":"简体中文",ja:"日本語",pt:"Português",ptbr:"Português do Brasil",ca:"Català",it:"Italiano",da:"Dansk",id:"Indonesia",uk:"Українська"},oT.lang.setLang=function(a){a&&(localStorage.setItem("oTranscribe-language",a),window.location.reload())},oT.lang.applyLang=function(){var a=localStorage.getItem("oTranscribe-language");document.webL10n.setLanguage(a?a:"en")},oT.lang.togglePanel=function(){$(".language-picker").toggleClass("active"),$(".language-title").toggleClass("active")},oT.lang.bide=function(){"complete"===document.webL10n.getReadyState()?oT.lang.applyLang():setTimeout(function(){oT.lang.bide()},50)},window.oT.lang=oT.lang,Mousetrap.bind("escape",function(a){return v(a),oT.player.playPause(),!1}),Mousetrap.bind("f1",function(a){return v(a),oT.player.skip("backwards"),!1}),Mousetrap.bind("f2",function(a){return v(a),oT.player.skip("forwards"),!1}),Mousetrap.bind("f3",function(a){return v(a),oT.player.speed("down"),!1}),Mousetrap.bind("f4",function(a){return v(a),oT.player.speed("up"),!1}),Mousetrap.bind("mod+j",function(a){return v(a),oT.timestamp.insert(),!1}),Mousetrap.bind("mod+s",function(a){return v(a),oT.backup.save(),!1}),Mousetrap.bind("mod+b",function(a){return v(a),document.execCommand("bold",!1,null),!1}),Mousetrap.bind("mod+i",function(a){return v(a),document.execCommand("italic",!1,null),!1}),$(".play-pause").click(function(){oT.player.playPause()}),$(".skip-backwards").click(function(){oT.player.skip("backwards")}),$(".skip-forwards").click(function(){oT.player.skip("forwards")}),$(".button.reset").click(function(){oT.media.reset({input:!0})}),$(".speed").click(function(){$(".speed-box").not(":hover").length&&$(this).toggleClass("fixed")}),$("#slider3").change(function(){oT.player.speed(this.valueAsNumber)}),$(".title").click(function(){b()}),$(".language-title").click(function(){oT.lang.togglePanel()}),$(".language-button").click(function(){oT.lang.setLang($(this).data("language"))}),$(".about .start").click(function(){$(this).hasClass("ready")&&b()}),$("#attach").change(function(){oT.input.reactToFile(this)}),$("#local-file-import").change(function(){oT.import.localButtonReaction(this)}),$(".yt-input").click(function(){oT.input.askForYoutube()}),$(".close-ext-input").click(function(){oT.input.returnToNormal()}),$(".sbutton.export").click(function(){t()}),$(".sbutton.backup").click(function(){oT.backup.openPanel()}),$(".backup-close").click(function(){oT.backup.closePanel()}),$(".textbox-container").click(function(a){return $(a.target).is("#icon-exp")||$(a.target).is(".export-panel")||$(a.target).is(".sbutton.export")?void a.preventDefault():void u()}),$(".export-panel").click(function(a){a.stopPropagation()}),$(".close-message-panel").click(function(){oT.message.close()})}(),oT.timestamp={split:function(a){var b=a.split(":"),c=60*+b[0]+ +b[1];return c},get:function(){if(!oT.player||!oT.player.getTime)return!1;var a=oT.player.getTime(),b=Math.floor(a/60),c=("0"+Math.floor(a-60*b)).slice(-2);return b+":"+c},insert:function(){var a=oT.timestamp.get();a&&(document.execCommand("insertHTML",!1,'<span class="timestamp" contenteditable="false" data-timestamp="'+oT.timestamp.get()+'" >'+oT.timestamp.get()+"</span>&nbsp;"),oT.timestamp.activate())},activate:function(){$(".timestamp").each(function(){$(this)[0].contentEditable=!1,$(this).off().click(function(){var a=$(this).attr("data-timestamp")||$(this).text();oT.player.skipTo(oT.timestamp.split(a))})})}};var ts={setFrom:function(a,b){1==b.childNodes.length&&oT.player.skipTo(oT.timestamp.split(a))}};
//# sourceMappingURL=script.map